VERSION 5.00
Object = "{F856EC8B-F03C-4515-BDC6-64CBD617566A}#8.0#0"; "fpSPR80.OCX"
Object = "{86CF1D34-0C5F-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCT2.OCX"
Object = "{F20E41DE-526A-423A-B746-D860D06076B4}#4.0#0"; "IGThreed40.ocx"
Object = "{A5CC20C4-B5F5-11CD-98EC-0020AF234C9D}#4.1#0"; "CSText32.ocx"
Object = "{A8E5842E-102B-4289-9D57-3B3F5B5E15D3}#13.2#0"; "Codejock.Controls.v13.2.1.ocx"
Object = "{14ACBB92-9C4A-4C45-AFD2-7AE60E71E5B3}#4.0#0"; "IGSplitter40.ocx"
Begin VB.Form frm세탁물지연문자 
   Caption         =   "세탁물 지연 문자"
   ClientHeight    =   11430
   ClientLeft      =   2220
   ClientTop       =   3180
   ClientWidth     =   15375
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "굴림체"
      Size            =   9.75
      Charset         =   129
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form23"
   LockControls    =   -1  'True
   MDIChild        =   -1  'True
   ScaleHeight     =   11430
   ScaleWidth      =   15375
   WindowState     =   2  '최대화
   Begin Threed.SSPanel pnlProg 
      Height          =   735
      Left            =   60
      TabIndex        =   62
      Top             =   2085
      Visible         =   0   'False
      Width           =   6015
      _ExtentX        =   10610
      _ExtentY        =   1296
      _Version        =   262144
      Font3D          =   3
      CaptionStyle    =   1
      ForeColor       =   16711680
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "굴림체"
         Size            =   9.75
         Charset         =   129
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      PictureBackgroundStyle=   2
      PictureBackground=   "frm세탁물지연문자.frx":0000
      BorderWidth     =   0
      BevelOuter      =   0
      BevelInner      =   2
      RoundedCorners  =   0   'False
      FloodShowPct    =   -1  'True
   End
   Begin SSSplitter.SSSplitter SSSplitter1 
      Height          =   11430
      Left            =   0
      TabIndex        =   2
      Top             =   0
      Width           =   15375
      _ExtentX        =   27120
      _ExtentY        =   20161
      _Version        =   262144
      AutoSize        =   1
      SplitterBarWidth=   1
      SplitterBarAppearance=   1
      BorderStyle     =   1
      PaneTree        =   "frm세탁물지연문자.frx":0226
      Begin Threed.SSPanel SSPanel 
         Height          =   465
         Index           =   0
         Left            =   15
         TabIndex        =   3
         Top             =   1215
         Width           =   9930
         _ExtentX        =   17515
         _ExtentY        =   820
         _Version        =   262144
         BevelOuter      =   0
         RoundedCorners  =   0   'False
         FloodShowPct    =   -1  'True
         Begin CSTextLibCtl.silgEdit txtCount 
            Height          =   330
            Index           =   0
            Left            =   5145
            TabIndex        =   4
            Top             =   75
            Width           =   705
            _Version        =   262145
            _ExtentX        =   1244
            _ExtentY        =   582
            _StockProps     =   125
            Text            =   " 0"
            ForeColor       =   -2147483640
            BackColor       =   -2147483643
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Tahoma"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DataProperty    =   2
            ReadOnly        =   -1  'True
            Modified        =   -1  'True
            HideSelection   =   -1  'True
            RawData         =   "0"
            Text            =   " 0"
            StartText.x     =   2
            StartText.y     =   3
            FirstVisPos     =   0
            HiAnchor        =   0
            HiNew           =   0
            CaretHeight     =   16
            CurNumDataChars =   0
            MaxDataChars    =   0
            FirstDataPos    =   0
            CurPos          =   0
            MaxLen          =   0
            DataReadOnly    =   0   'False
            Mask            =   ""
            Justification   =   2
            Undo            =   1
            Data            =   0
         End
         Begin CSTextLibCtl.silgEdit txtCount 
            Height          =   330
            Index           =   1
            Left            =   7005
            TabIndex        =   5
            Top             =   75
            Width           =   705
            _Version        =   262145
            _ExtentX        =   1244
            _ExtentY        =   582
            _StockProps     =   125
            Text            =   " 0"
            ForeColor       =   -2147483640
            BackColor       =   -2147483643
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Tahoma"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DataProperty    =   2
            ReadOnly        =   -1  'True
            Modified        =   -1  'True
            HideSelection   =   -1  'True
            RawData         =   "0"
            Text            =   " 0"
            StartText.x     =   2
            StartText.y     =   3
            FirstVisPos     =   0
            HiAnchor        =   0
            HiNew           =   0
            CaretHeight     =   16
            CurNumDataChars =   0
            MaxDataChars    =   0
            FirstDataPos    =   0
            CurPos          =   0
            MaxLen          =   0
            DataReadOnly    =   0   'False
            Mask            =   ""
            Justification   =   2
            Undo            =   1
            Data            =   0
         End
         Begin CSTextLibCtl.silgEdit txtCount 
            Height          =   330
            Index           =   2
            Left            =   9165
            TabIndex        =   6
            Top             =   75
            Width           =   705
            _Version        =   262145
            _ExtentX        =   1244
            _ExtentY        =   582
            _StockProps     =   125
            Text            =   " 0"
            ForeColor       =   -2147483640
            BackColor       =   -2147483643
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "Tahoma"
               Size            =   9.75
               Charset         =   0
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            DataProperty    =   2
            ReadOnly        =   -1  'True
            Modified        =   -1  'True
            HideSelection   =   -1  'True
            RawData         =   "0"
            Text            =   " 0"
            StartText.x     =   2
            StartText.y     =   3
            FirstVisPos     =   0
            HiAnchor        =   0
            HiNew           =   0
            CaretHeight     =   16
            CurNumDataChars =   0
            MaxDataChars    =   0
            FirstDataPos    =   0
            CurPos          =   0
            MaxLen          =   0
            DataReadOnly    =   0   'False
            Mask            =   ""
            Justification   =   2
            Undo            =   1
            Data            =   0
         End
         Begin XtremeSuiteControls.PushButton btnSelect 
            Height          =   390
            Index           =   0
            Left            =   45
            TabIndex        =   7
            Top             =   45
            Width           =   1005
            _Version        =   851970
            _ExtentX        =   1773
            _ExtentY        =   688
            _StockProps     =   79
            Caption         =   "전체선택"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Appearance      =   6
         End
         Begin XtremeSuiteControls.PushButton btnSelect 
            Height          =   390
            Index           =   1
            Left            =   1080
            TabIndex        =   8
            Top             =   45
            Width           =   1005
            _Version        =   851970
            _ExtentX        =   1773
            _ExtentY        =   688
            _StockProps     =   79
            Caption         =   "전체취소"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Appearance      =   6
         End
         Begin XtremeSuiteControls.PushButton btnSelect 
            Height          =   390
            Index           =   2
            Left            =   3210
            TabIndex        =   100
            Top             =   45
            Width           =   1005
            _Version        =   851970
            _ExtentX        =   1773
            _ExtentY        =   688
            _StockProps     =   79
            Caption         =   "수량조회"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Appearance      =   6
         End
         Begin VB.Label Label2 
            Alignment       =   1  '오른쪽 맞춤
            AutoSize        =   -1  'True
            BackStyle       =   0  '투명
            Caption         =   "남은수량:"
            BeginProperty Font 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   180
            Index           =   2
            Left            =   4290
            TabIndex        =   11
            Top             =   165
            Width           =   810
         End
         Begin VB.Label Label2 
            Alignment       =   1  '오른쪽 맞춤
            AutoSize        =   -1  'True
            BackStyle       =   0  '투명
            Caption         =   "선택수량:"
            BeginProperty Font 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   180
            Index           =   5
            Left            =   6135
            TabIndex        =   10
            Top             =   165
            Width           =   810
         End
         Begin VB.Label Label2 
            Alignment       =   1  '오른쪽 맞춤
            AutoSize        =   -1  'True
            BackStyle       =   0  '투명
            Caption         =   "전송후 수량:"
            BeginProperty Font 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   180
            Index           =   7
            Left            =   8025
            TabIndex        =   9
            Top             =   165
            Width           =   1080
         End
      End
      Begin Threed.SSPanel pnlHeader 
         Height          =   420
         Left            =   15
         TabIndex        =   12
         Top             =   15
         Width           =   15345
         _ExtentX        =   27067
         _ExtentY        =   741
         _Version        =   262144
         Font3D          =   1
         ForeColor       =   0
         BackColor       =   16777215
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "굴림체"
            Size            =   11.25
            Charset         =   129
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "      세탁물 지연 문자"
         PictureBackgroundStyle=   2
         PictureBackground=   "frm세탁물지연문자.frx":02F8
         BorderWidth     =   0
         BevelOuter      =   0
         Alignment       =   1
         RoundedCorners  =   0   'False
         FloodShowPct    =   -1  'True
         Begin VB.Image Image 
            Height          =   480
            Index           =   0
            Left            =   0
            Picture         =   "frm세탁물지연문자.frx":051E
            Top             =   -15
            Width           =   765
         End
      End
      Begin Threed.SSPanel SSPanel3 
         Height          =   750
         Left            =   15
         TabIndex        =   13
         Top             =   450
         Width           =   15345
         _ExtentX        =   27067
         _ExtentY        =   1323
         _Version        =   262144
         BevelOuter      =   0
         RoundedCorners  =   0   'False
         FloodShowPct    =   -1  'True
         Begin XtremeSuiteControls.PushButton btnSelect 
            Height          =   330
            Index           =   4
            Left            =   7095
            TabIndex        =   96
            Top             =   60
            Width           =   2055
            _Version        =   851970
            _ExtentX        =   3625
            _ExtentY        =   582
            _StockProps     =   79
            Caption         =   "이후 발송자 선택 취소"
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Appearance      =   6
         End
         Begin MSComCtl2.DTPicker dtpDay 
            Height          =   315
            Index           =   2
            Left            =   5565
            TabIndex        =   97
            Top             =   60
            Width           =   1425
            _ExtentX        =   2514
            _ExtentY        =   556
            _Version        =   393216
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "굴림체"
               Size            =   9.75
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            CustomFormat    =   "yyyy-MM-dd"
            Format          =   63242243
            CurrentDate     =   40537
         End
         Begin MSComCtl2.DTPicker dtpDay 
            Height          =   315
            Index           =   1
            Left            =   2610
            TabIndex        =   1
            Top             =   45
            Width           =   1425
            _ExtentX        =   2514
            _ExtentY        =   556
            _Version        =   393216
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "굴림체"
               Size            =   9.75
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            CustomFormat    =   "yyyy-MM-dd"
            Format          =   63242243
            CurrentDate     =   39596
         End
         Begin XtremeSuiteControls.PushButton cmdList 
            Height          =   630
            Left            =   9840
            TabIndex        =   14
            Top             =   60
            Width           =   1500
            _Version        =   851970
            _ExtentX        =   2646
            _ExtentY        =   1111
            _StockProps     =   79
            Caption         =   " 조회(&F)"
            Appearance      =   6
            Picture         =   "frm세탁물지연문자.frx":10E8
         End
         Begin XtremeSuiteControls.PushButton cmdBtn 
            Height          =   630
            Index           =   5
            Left            =   11385
            TabIndex        =   15
            Top             =   60
            Width           =   1500
            _Version        =   851970
            _ExtentX        =   2646
            _ExtentY        =   1111
            _StockProps     =   79
            Caption         =   " 닫기(&X)"
            ForeColor       =   0
            Appearance      =   6
            Picture         =   "frm세탁물지연문자.frx":17E2
         End
         Begin MSComCtl2.DTPicker dtpDay 
            Height          =   315
            Index           =   0
            Left            =   915
            TabIndex        =   0
            Top             =   45
            Width           =   1425
            _ExtentX        =   2514
            _ExtentY        =   556
            _Version        =   393216
            BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
               Name            =   "굴림체"
               Size            =   9.75
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            CustomFormat    =   "yyyy-MM-dd"
            Format          =   63242243
            CurrentDate     =   40537
         End
         Begin XtremeSuiteControls.PushButton cmdBtn 
            Height          =   630
            Index           =   4
            Left            =   7395
            TabIndex        =   98
            Top             =   480
            Visible         =   0   'False
            Width           =   1620
            _Version        =   851970
            _ExtentX        =   2857
            _ExtentY        =   1111
            _StockProps     =   79
            Caption         =   "개별발송"
            Appearance      =   6
            Picture         =   "frm세탁물지연문자.frx":2874
         End
         Begin VB.Label Label2 
            Alignment       =   1  '오른쪽 맞춤
            AutoSize        =   -1  'True
            BackStyle       =   0  '투명
            Caption         =   "SMS 최종전송일"
            BeginProperty Font 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   180
            Index           =   3
            Left            =   4275
            TabIndex        =   99
            Top             =   120
            Width           =   1260
         End
         Begin VB.Shape Shape1 
            BorderColor     =   &H00C0C0FF&
            FillColor       =   &H00C0C0FF&
            FillStyle       =   0  '단색
            Height          =   375
            Left            =   4080
            Top             =   30
            Width           =   5205
         End
         Begin VB.Label Label2 
            Alignment       =   1  '오른쪽 맞춤
            AutoSize        =   -1  'True
            BackStyle       =   0  '투명
            Caption         =   "접수일자:"
            BeginProperty Font 
               Name            =   "굴림체"
               Size            =   9
               Charset         =   129
               Weight          =   400
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            ForeColor       =   &H00000000&
            Height          =   180
            Index           =   1
            Left            =   45
            TabIndex        =   17
            Top             =   105
            Width           =   840
         End
         Begin VB.Label Label2 
            AutoSize        =   -1  'True
            BackStyle       =   0  '투명
            Caption         =   "~"
            BeginProperty Font 
               Name            =   "굴림체"
               Size            =   9.75
               Charset         =   129
               Weight          =   700
               Underline       =   0   'False
               Italic          =   0   'False
               Strikethrough   =   0   'False
            EndProperty
            Height          =   195
            Index           =   0
            Left            =   2415
            TabIndex        =   16
            Top             =   105
            Width           =   120
         End
      End
      Begin FPSpreadADO.fpSpread sprDetail 
         Height          =   3285
         Left            =   15
         TabIndex        =   18
         Top             =   8130
         Width           =   9930
         _Version        =   524288
         _ExtentX        =   17515
         _ExtentY        =   5794
         _StockProps     =   64
         AllowDragDrop   =   -1  'True
         AllowUserFormulas=   -1  'True
         AutoCalc        =   0   'False
         AutoClipboard   =   0   'False
         BackColorStyle  =   1
         DAutoCellTypes  =   0   'False
         DAutoHeadings   =   0   'False
         DAutoSave       =   0   'False
         DAutoSizeCols   =   0
         DInformActiveRowChange=   0   'False
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "굴림체"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         GrayAreaBackColor=   16777215
         GridSolid       =   0   'False
         MaxCols         =   8
         MaxRows         =   300
         MoveActiveOnFocus=   0   'False
         Protect         =   0   'False
         ScrollBars      =   2
         SpreadDesigner  =   "frm세탁물지연문자.frx":2F6E
         VisibleCols     =   2
         VisibleRows     =   50
         HighlightHeaders=   1
         HighlightStyle  =   1
      End
      Begin FPSpreadADO.fpSpread sprGrid 
         Height          =   6420
         Left            =   15
         TabIndex        =   19
         Top             =   1695
         Width           =   9930
         _Version        =   524288
         _ExtentX        =   17515
         _ExtentY        =   11324
         _StockProps     =   64
         AllowDragDrop   =   -1  'True
         AllowUserFormulas=   -1  'True
         AutoCalc        =   0   'False
         AutoClipboard   =   0   'False
         BackColorStyle  =   1
         DAutoCellTypes  =   0   'False
         DAutoHeadings   =   0   'False
         DAutoSave       =   0   'False
         DAutoSizeCols   =   0
         DInformActiveRowChange=   0   'False
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "굴림체"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         GrayAreaBackColor=   16777215
         GridSolid       =   0   'False
         MaxCols         =   10
         MaxRows         =   300
         MoveActiveOnFocus=   0   'False
         SpreadDesigner  =   "frm세탁물지연문자.frx":3659
         VisibleCols     =   2
         VisibleRows     =   50
         HighlightHeaders=   1
         HighlightStyle  =   1
      End
      Begin XtremeSuiteControls.TabControl TabControl 
         Height          =   10200
         Left            =   9960
         TabIndex        =   20
         Top             =   1215
         Width           =   5400
         _Version        =   851970
         _ExtentX        =   9525
         _ExtentY        =   17992
         _StockProps     =   68
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "굴림체"
            Size            =   9
            Charset         =   129
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Appearance      =   3
         Color           =   16
         PaintManager.BoldSelected=   -1  'True
         PaintManager.HotTracking=   -1  'True
         PaintManager.ShowIcons=   -1  'True
         PaintManager.ButtonMargin=   "0,3,0,3"
         ItemCount       =   2
         SelectedItem    =   1
         Item(0).Caption =   "발송정보"
         Item(0).ControlCount=   1
         Item(0).Control(0)=   "TabControlPage(0)"
         Item(1).Caption =   "개별 문자발송"
         Item(1).ControlCount=   1
         Item(1).Control(0)=   "TabControlPage1"
         Begin XtremeSuiteControls.TabControlPage TabControlPage1 
            Height          =   9720
            Left            =   30
            TabIndex        =   21
            Top             =   450
            Width           =   5340
            _Version        =   851970
            _ExtentX        =   9419
            _ExtentY        =   17145
            _StockProps     =   1
            BackColor       =   16777215
            Page            =   1
            Begin VB.TextBox txtServer 
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   315
               Index           =   0
               Left            =   1365
               TabIndex        =   26
               Top             =   7650
               Visible         =   0   'False
               Width           =   2895
            End
            Begin VB.TextBox txtServer 
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   315
               Index           =   1
               Left            =   1365
               TabIndex        =   25
               Top             =   7995
               Visible         =   0   'False
               Width           =   2895
            End
            Begin VB.TextBox txtServer 
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   315
               Index           =   2
               Left            =   1365
               TabIndex        =   24
               Top             =   8340
               Visible         =   0   'False
               Width           =   2895
            End
            Begin VB.TextBox txtServer 
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   315
               Index           =   3
               Left            =   1365
               TabIndex        =   23
               Top             =   8685
               Visible         =   0   'False
               Width           =   2895
            End
            Begin VB.TextBox txtRecvTel 
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9.75
                  Charset         =   129
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Left            =   2565
               Locked          =   -1  'True
               TabIndex        =   22
               Top             =   5880
               Width           =   2265
            End
            Begin XtremeSuiteControls.PushButton cmdSvr 
               Height          =   450
               Index           =   0
               Left            =   885
               TabIndex        =   27
               Top             =   9090
               Visible         =   0   'False
               Width           =   1230
               _Version        =   851970
               _ExtentX        =   2170
               _ExtentY        =   794
               _StockProps     =   79
               Caption         =   "초기화"
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               UseVisualStyle  =   -1  'True
            End
            Begin XtremeSuiteControls.PushButton cmdSvr 
               Height          =   450
               Index           =   1
               Left            =   2145
               TabIndex        =   28
               Top             =   9090
               Visible         =   0   'False
               Width           =   1230
               _Version        =   851970
               _ExtentX        =   2170
               _ExtentY        =   794
               _StockProps     =   79
               Caption         =   "연결 확인"
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               UseVisualStyle  =   -1  'True
            End
            Begin XtremeSuiteControls.PushButton cmdSvr 
               Height          =   450
               Index           =   2
               Left            =   3405
               TabIndex        =   29
               Top             =   9090
               Visible         =   0   'False
               Width           =   1230
               _Version        =   851970
               _ExtentX        =   2170
               _ExtentY        =   794
               _StockProps     =   79
               Caption         =   "저장"
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               UseVisualStyle  =   -1  'True
            End
            Begin Threed.SSPanel SSPanel 
               Height          =   2100
               Index           =   1
               Left            =   75
               TabIndex        =   30
               Top             =   5280
               Width           =   2070
               _ExtentX        =   3651
               _ExtentY        =   3704
               _Version        =   262144
               BackColor       =   16777215
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":3E62
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.TextBox txtSend2 
                  BackColor       =   &H00FFFFFF&
                  BorderStyle     =   0  '없음
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9.75
                     Charset         =   129
                     Weight          =   700
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1575
                  Left            =   120
                  MultiLine       =   -1  'True
                  TabIndex        =   31
                  Top             =   360
                  Width           =   1830
               End
               Begin VB.Label lblLan2 
                  Alignment       =   1  '오른쪽 맞춤
                  AutoSize        =   -1  'True
                  BackColor       =   &H00FFFFFF&
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   700
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H000000C0&
                  Height          =   180
                  Left            =   1200
                  TabIndex        =   32
                  Top             =   105
                  Width           =   105
               End
            End
            Begin Threed.SSFrame SSFrame 
               Height          =   5040
               Index           =   1
               Left            =   105
               TabIndex        =   33
               Top             =   105
               Width           =   2145
               _ExtentX        =   3784
               _ExtentY        =   8890
               _Version        =   262144
               BackColor       =   16777215
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Caption         =   "받는 사람"
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   9
                  Left            =   90
                  TabIndex        =   43
                  Top             =   3915
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   8
                  Left            =   90
                  TabIndex        =   42
                  Top             =   3510
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   7
                  Left            =   90
                  TabIndex        =   41
                  Top             =   3105
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   6
                  Left            =   90
                  TabIndex        =   40
                  Top             =   2700
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   5
                  Left            =   90
                  TabIndex        =   39
                  Top             =   2295
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   4
                  Left            =   90
                  TabIndex        =   38
                  Top             =   1890
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   3
                  Left            =   90
                  TabIndex        =   37
                  Top             =   1485
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   2
                  Left            =   90
                  TabIndex        =   36
                  Top             =   1080
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   1
                  Left            =   90
                  TabIndex        =   35
                  Top             =   675
                  Width           =   1950
               End
               Begin VB.TextBox txtMobile 
                  Height          =   360
                  Index           =   0
                  Left            =   90
                  TabIndex        =   34
                  Top             =   270
                  Width           =   1950
               End
            End
            Begin XtremeSuiteControls.PushButton cmdSend 
               Height          =   630
               Left            =   2565
               TabIndex        =   44
               Top             =   6300
               Width           =   2250
               _Version        =   851970
               _ExtentX        =   3969
               _ExtentY        =   1111
               _StockProps     =   79
               Caption         =   " 문자보내기"
               Appearance      =   6
               Picture         =   "frm세탁물지연문자.frx":12004
            End
            Begin Threed.SSPanel SSPanel2 
               Height          =   30
               Index           =   1
               Left            =   90
               TabIndex        =   90
               Top             =   5205
               Width           =   5160
               _ExtentX        =   9102
               _ExtentY        =   53
               _Version        =   262144
               BevelOuter      =   1
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
            End
            Begin VB.Label Label2 
               AutoSize        =   -1  'True
               BackStyle       =   0  '투명
               Caption         =   $"frm세탁물지연문자.frx":126FE
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H000000FF&
               Height          =   720
               Index           =   4
               Left            =   2580
               TabIndex        =   101
               Top             =   3630
               Width           =   2340
            End
            Begin VB.Label lblTitle 
               Alignment       =   1  '오른쪽 맞춤
               BackColor       =   &H00FFC0C0&
               BackStyle       =   0  '투명
               Caption         =   "서버 IP :"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   1
               Left            =   165
               TabIndex        =   49
               Top             =   7725
               Visible         =   0   'False
               Width           =   1140
            End
            Begin VB.Label lblTitle 
               Alignment       =   1  '오른쪽 맞춤
               BackColor       =   &H00FFC0C0&
               BackStyle       =   0  '투명
               Caption         =   "서버 DB :"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   2
               Left            =   165
               TabIndex        =   48
               Top             =   8070
               Visible         =   0   'False
               Width           =   1140
            End
            Begin VB.Label lblTitle 
               Alignment       =   1  '오른쪽 맞춤
               BackColor       =   &H00FFC0C0&
               BackStyle       =   0  '투명
               Caption         =   "사용자 이름:"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   3
               Left            =   165
               TabIndex        =   47
               Top             =   8415
               Visible         =   0   'False
               Width           =   1140
            End
            Begin VB.Label lblTitle 
               Alignment       =   1  '오른쪽 맞춤
               BackColor       =   &H00FFC0C0&
               BackStyle       =   0  '투명
               Caption         =   "비밀번호 :"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   4
               Left            =   165
               TabIndex        =   46
               Top             =   8760
               Visible         =   0   'False
               Width           =   1140
            End
            Begin VB.Label lblTitle 
               BackColor       =   &H00FFC0C0&
               BackStyle       =   0  '투명
               Caption         =   "보내는 사람"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   225
               Index           =   8
               Left            =   2865
               TabIndex        =   45
               Top             =   5610
               Width           =   1200
            End
            Begin VB.Image Image 
               Height          =   240
               Index           =   1
               Left            =   2535
               Picture         =   "frm세탁물지연문자.frx":12764
               Top             =   5595
               Width           =   240
            End
         End
         Begin XtremeSuiteControls.TabControlPage TabControlPage 
            Height          =   9720
            Index           =   0
            Left            =   -69970
            TabIndex        =   50
            Top             =   450
            Visible         =   0   'False
            Width           =   5340
            _Version        =   851970
            _ExtentX        =   9419
            _ExtentY        =   17145
            _StockProps     =   1
            BackColor       =   16777215
            Page            =   0
            Begin Threed.SSPanel SSPanel2 
               Height          =   30
               Index           =   0
               Left            =   90
               TabIndex        =   89
               Top             =   5205
               Width           =   5160
               _ExtentX        =   9102
               _ExtentY        =   53
               _Version        =   262144
               BevelOuter      =   1
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
            End
            Begin VB.TextBox Text1 
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9.75
                  Charset         =   129
                  Weight          =   700
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   375
               Left            =   2565
               Locked          =   -1  'True
               TabIndex        =   55
               Top             =   6750
               Width           =   2265
            End
            Begin Threed.SSPanel SSPanel1 
               Height          =   2115
               Left            =   75
               TabIndex        =   51
               Top             =   5280
               Width           =   2055
               _ExtentX        =   3625
               _ExtentY        =   3731
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":12AEE
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.TextBox txtSMS 
                  Appearance      =   0  '평면
                  BorderStyle     =   0  '없음
                  Height          =   1590
                  Left            =   90
                  MultiLine       =   -1  'True
                  TabIndex        =   52
                  Top             =   360
                  Width           =   1875
               End
               Begin VB.Label lblNum 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   700
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FF0000&
                  Height          =   180
                  Left            =   555
                  TabIndex        =   54
                  Top             =   90
                  Width           =   105
               End
               Begin VB.Label lbl_SMS 
                  Alignment       =   1  '오른쪽 맞춤
                  Appearance      =   0  '평면
                  AutoSize        =   -1  'True
                  BackColor       =   &H80000005&
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   700
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H000000C0&
                  Height          =   180
                  Left            =   1200
                  TabIndex        =   53
                  Top             =   90
                  Width           =   105
               End
            End
            Begin XtremeSuiteControls.PushButton cmdBtn 
               Height          =   630
               Index           =   1
               Left            =   2565
               TabIndex        =   56
               Top             =   7170
               Width           =   2250
               _Version        =   851970
               _ExtentX        =   3969
               _ExtentY        =   1111
               _StockProps     =   79
               Caption         =   " 문자메시지 보내기"
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Appearance      =   6
               Picture         =   "frm세탁물지연문자.frx":20C90
            End
            Begin XtremeSuiteControls.PushButton cmdSendTextSave 
               Height          =   390
               Index           =   2
               Left            =   1065
               TabIndex        =   57
               ToolTipText     =   "메시지 삭제..."
               Top             =   7410
               Width           =   435
               _Version        =   851970
               _ExtentX        =   767
               _ExtentY        =   688
               _StockProps     =   79
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Appearance      =   6
               Picture         =   "frm세탁물지연문자.frx":2138A
            End
            Begin XtremeSuiteControls.PushButton cmdSendTextSave 
               Height          =   390
               Index           =   1
               Left            =   570
               TabIndex        =   58
               ToolTipText     =   "메시지 수정..."
               Top             =   7410
               Width           =   435
               _Version        =   851970
               _ExtentX        =   767
               _ExtentY        =   688
               _StockProps     =   79
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Appearance      =   6
               Picture         =   "frm세탁물지연문자.frx":21924
            End
            Begin XtremeSuiteControls.PushButton cmdSendTextSave 
               Height          =   390
               Index           =   0
               Left            =   75
               TabIndex        =   59
               ToolTipText     =   "메시지 추가..."
               Top             =   7410
               Width           =   435
               _Version        =   851970
               _ExtentX        =   767
               _ExtentY        =   688
               _StockProps     =   79
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Appearance      =   6
               Picture         =   "frm세탁물지연문자.frx":21EBE
            End
            Begin XtremeSuiteControls.PushButton cmdChange 
               Height          =   390
               Left            =   1695
               TabIndex        =   60
               ToolTipText     =   "암호변경..."
               Top             =   7410
               Width           =   435
               _Version        =   851970
               _ExtentX        =   767
               _ExtentY        =   688
               _StockProps     =   79
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Appearance      =   6
               Picture         =   "frm세탁물지연문자.frx":22458
            End
            Begin XtremeSuiteControls.PushButton btnMove 
               Height          =   360
               Index           =   0
               Left            =   3570
               TabIndex        =   63
               Top             =   5280
               Width           =   825
               _Version        =   851970
               _ExtentX        =   1455
               _ExtentY        =   635
               _StockProps     =   79
               Caption         =   "< 이전"
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               UseVisualStyle  =   -1  'True
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   0
               Left            =   75
               TabIndex        =   64
               Top             =   75
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":229F2
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   0
                  Left            =   135
                  TabIndex        =   66
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   0
                  Left            =   105
                  TabIndex        =   65
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   1
               Left            =   1800
               TabIndex        =   67
               Top             =   75
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":27607
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   1
                  Left            =   135
                  TabIndex        =   69
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   1
                  Left            =   105
                  TabIndex        =   68
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   2
               Left            =   3525
               TabIndex        =   70
               Top             =   75
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":2C21C
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   2
                  Left            =   135
                  TabIndex        =   72
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   2
                  Left            =   105
                  TabIndex        =   71
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   3
               Left            =   75
               TabIndex        =   73
               Top             =   1770
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":30E31
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   3
                  Left            =   135
                  TabIndex        =   75
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   3
                  Left            =   105
                  TabIndex        =   74
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   4
               Left            =   1800
               TabIndex        =   76
               Top             =   1770
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":35A46
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   4
                  Left            =   135
                  TabIndex        =   78
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   4
                  Left            =   105
                  TabIndex        =   77
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   5
               Left            =   3525
               TabIndex        =   79
               Top             =   1770
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":3A65B
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   5
                  Left            =   135
                  TabIndex        =   81
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   5
                  Left            =   105
                  TabIndex        =   80
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   6
               Left            =   75
               TabIndex        =   82
               Top             =   3465
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":3F270
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   6
                  Left            =   135
                  TabIndex        =   84
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   6
                  Left            =   105
                  TabIndex        =   83
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   7
               Left            =   1800
               TabIndex        =   85
               Top             =   3465
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":43E85
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   7
                  Left            =   135
                  TabIndex        =   87
                  Top             =   60
                  Width           =   90
               End
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   7
                  Left            =   105
                  TabIndex        =   86
                  Top             =   360
                  Width           =   1500
               End
            End
            Begin XtremeSuiteControls.PushButton btnMove 
               Height          =   360
               Index           =   1
               Left            =   4410
               TabIndex        =   88
               Top             =   5280
               Width           =   825
               _Version        =   851970
               _ExtentX        =   1455
               _ExtentY        =   635
               _StockProps     =   79
               Caption         =   "다음 >"
               BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               UseVisualStyle  =   -1  'True
            End
            Begin Threed.SSPanel pnlSMS 
               Height          =   1680
               Index           =   8
               Left            =   3525
               TabIndex        =   91
               Top             =   3465
               Width           =   1710
               _ExtentX        =   3016
               _ExtentY        =   2963
               _Version        =   262144
               PictureFrames   =   1
               Picture         =   "frm세탁물지연문자.frx":48A9A
               BorderWidth     =   0
               BevelOuter      =   0
               RoundedCorners  =   0   'False
               FloodShowPct    =   -1  'True
               Begin VB.Label lblSMSMsg 
                  BackStyle       =   0  '투명
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  Height          =   1125
                  Index           =   8
                  Left            =   105
                  TabIndex        =   93
                  Top             =   360
                  Width           =   1500
               End
               Begin VB.Label lblNo 
                  AutoSize        =   -1  'True
                  BackStyle       =   0  '투명
                  Caption         =   "0"
                  BeginProperty Font 
                     Name            =   "굴림체"
                     Size            =   9
                     Charset         =   129
                     Weight          =   400
                     Underline       =   0   'False
                     Italic          =   0   'False
                     Strikethrough   =   0   'False
                  EndProperty
                  ForeColor       =   &H00FFFFFF&
                  Height          =   180
                  Index           =   8
                  Left            =   135
                  TabIndex        =   92
                  Top             =   60
                  Width           =   90
               End
            End
            Begin VB.Label Label2 
               AutoSize        =   -1  'True
               BackStyle       =   0  '투명
               Caption         =   $"frm세탁물지연문자.frx":4D6AF
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               ForeColor       =   &H000000FF&
               Height          =   720
               Index           =   6
               Left            =   2550
               TabIndex        =   102
               Top             =   5670
               Width           =   2340
            End
            Begin VB.Label lblPage 
               Alignment       =   2  '가운데 맞춤
               BackStyle       =   0  '투명
               Caption         =   "0"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   11.25
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   240
               Left            =   2565
               TabIndex        =   95
               Top             =   5325
               Width           =   300
            End
            Begin VB.Label lblPageCount 
               Alignment       =   2  '가운데 맞춤
               BackStyle       =   0  '투명
               Caption         =   "0"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   11.25
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   240
               Left            =   3030
               TabIndex        =   94
               Top             =   5325
               Width           =   300
            End
            Begin VB.Line Line1 
               X1              =   2985
               X2              =   2910
               Y1              =   5295
               Y2              =   5580
            End
            Begin VB.Image Image 
               Height          =   240
               Index           =   2
               Left            =   2535
               Picture         =   "frm세탁물지연문자.frx":4D715
               Top             =   6465
               Width           =   240
            End
            Begin VB.Label lblTitle 
               BackColor       =   &H00FFC0C0&
               BackStyle       =   0  '투명
               Caption         =   "보내는 사람"
               BeginProperty Font 
                  Name            =   "굴림체"
                  Size            =   9
                  Charset         =   129
                  Weight          =   400
                  Underline       =   0   'False
                  Italic          =   0   'False
                  Strikethrough   =   0   'False
               EndProperty
               Height          =   255
               Index           =   0
               Left            =   2865
               TabIndex        =   61
               Top             =   6480
               Width           =   1170
            End
         End
      End
   End
End
Attribute VB_Name = "frm세탁물지연문자"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim m_Host_DataBase     As ADODB.Connection
Dim m_Connect           As Boolean
Dim bCountFlag          As Boolean
Dim bSSChangeFlag       As Boolean
Dim bSSChangeFlag2      As Boolean

Private Sub btnMove_Click(Index As Integer)
    On Error GoTo ErrRtn
    
    If 가맹점정보.SMS_EMART = "Y" Then Exit Sub
        
    If Index = 0 Then
        If lblPage.Caption = "1" Then Exit Sub
        
        lblPage.Caption = Int(lblPage.Caption) - 1
        
        Query = "SELECT TOP (9) * FROM TB_문자발송문"
        Query = Query & " WHERE 순번 < '" & Format(lblNo(0).Caption, "00") & "'"
        Query = Query & " ORDER BY 순번 DESC"
        Set SUBRs = New ADODB.Recordset
        SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
    
        For i = 0 To 8
            lblNo(i).Caption = ""
            lblSMSMsg(i).Caption = ""
        Next i
        
        i = 8

        Do Until SUBRs.EOF
            If i < 0 Then Exit Do
            
            lblNo(i).Caption = Val(SUBRs!순번) & ""
            lblSMSMsg(i).Caption = Trim(SUBRs!내용) & ""
            
            i = i - 1
            
            SUBRs.MoveNext
        Loop
        SUBRs.Close
        Set SUBRs = Nothing
        
    Else
        If lblPage.Caption = lblPageCount.Caption Then Exit Sub
        
        If lblNo(8).Caption = "" Then Exit Sub
        
        lblPage.Caption = Int(lblPage.Caption) + 1
        
        '
        Query = "SELECT TOP (9) * FROM TB_문자발송문"
        Query = Query & " WHERE 순번 > '" & Format(lblNo(8).Caption, "00") & "'"
        Query = Query & " ORDER BY 순번 ASC"
        Set SUBRs = New ADODB.Recordset
        SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
    
        For i = 0 To 8
            lblNo(i).Caption = ""
            lblSMSMsg(i).Caption = ""
        Next i
        
        i = 0

        Do Until SUBRs.EOF
            If i > 8 Then Exit Do
            
            lblNo(i).Caption = Val(SUBRs!순번) & ""
            lblSMSMsg(i).Caption = Trim(SUBRs!내용) & ""
            
            i = i + 1
            
            SUBRs.MoveNext
        Loop
        SUBRs.Close
        Set SUBRs = Nothing
    End If

    lblNum.Caption = lblNo(0).Caption
    txtSMS.Text = lblSMSMsg(0).Caption & ""
    
    Exit Sub
    
ErrRtn:
    Call Error_Msg("", Err.Source, Err.Number, Err.description)

    Screen.MousePointer = 0
End Sub

'Private Sub cboSendText_Click()
'    If cboSendText.ListIndex >= 0 Then
'        txtSMS.Text = cboSendText.Text
'        txtSend2.Text = cboSendText.Text
'    End If
'End Sub

Private Sub cmdBtn_Click(Index As Integer)
    Select Case Index
        Case 1
            If CheckConnect = False Then Exit Sub
            Call SendSMS ' 발송
        
        Case 4 ' 개별 문자 메시지
            If cmdBtn(Index).Caption = "개별발송" Then
                cmdBtn(Index).Caption = "그룹발송"
                cmdBtn(1).Visible = False
            Else
                cmdBtn(Index).Caption = "개별발송"
                cmdBtn(1).Visible = True
            End If
            
            'pnlSend(0).ZOrder 0
            'pnlSend(0).Visible = Not pnlSend(0).Visible
            
        Case 5: Unload Me
    End Select
End Sub


Private Sub cmdChange_Click()
'+------------------------------------------------------
'+ 2003/02/11 수정
'+
'+루틴설명      - 비밀번호확인
'+  1. 암호를 확인하여 암호 규칙에 맞으면 화면을 종료한다.
'+  2. 레지스터리에 저장한다.
'+
'+------------------------------------------------------
    Dim strPass As String
    Dim bPass   As Boolean
    
    ' 입력 확인
    bPass = False
    
    strPass = InputBox("암호를 입력하여 주십시요", "SMS 암호")
    If Len(strPass) <= 0 Then
        Exit Sub
    End If
    
'   기본 디폴드 암호.. ( 프로그램 셋팅/설치를 위한 암호 )
    If UCase(strPass) = "DUDTJSGH" Or UCase(strPass) = "SHOP500" Then
        bPass = True
    Else
        ' 비밀번호 확인
        strPass = IsPassWord(strPass)
        If strPass = "-1" Or strPass = "-3" Then
            If strPass = "-3" Then MsgBox "입력한 내용이 정확하지 않습니다.", vbCritical, "입력오류"
            Exit Sub
        Else
            bPass = True
        End If
    End If
    
    ' 암호를 입력 하였으면
    If bPass = True Then
        m_SMS_EMART_PASS = True
        cmdBtn(4).Enabled = True
        txtSMS.Enabled = True
        txtSMS.Locked = False

    End If
End Sub

Private Sub btnSelect_Click(Index As Integer)
    Dim lRow    As Long
    Dim sTel(2) As String
    
    On Error GoTo ErrRtn
    
    Select Case Index
        Case 1
        ' 전체 취소
            For lRow = 1 To sprGrid.MaxRows
                sprGrid.Row = lRow
                sprGrid.Col = 1
                
                If sprGrid.Value = 1 Then
                    sprGrid.SetText 1, lRow, "0"
                End If
            Next lRow
            
            txtCount(1).Value = CStr(GetSelectSpread(sprGrid, 1))
            Exit Sub
            
        Case 2
            If CheckConnect = True Then
                Call SetUseSMSCount ' 최종 남은 수량을 설정한다.
            End If
            Exit Sub
            
        Case 4
        ' 발송자 취소
            For lRow = 1 To sprGrid.MaxRows
                sprGrid.Row = lRow
                sprGrid.Col = 9
                
                If Len(Trim(sprGrid.Text)) > 0 And Left(Trim(sprGrid.Text), 10) >= Format(dtpDay(2).Value, "YYYY-MM-DD") Then
                    sprGrid.SetText 1, lRow, "0"
                End If
            Next lRow
            
            txtCount(1).Value = CStr(GetSelectSpread(sprGrid, 1))
            
        Case 0
            For lRow = 1 To sprGrid.MaxRows
                sprGrid.Row = lRow
                sprGrid.Col = 4
                
                ' 휴대폰 번호가 있을경우
                If sprGrid.Text <> "" Then
                    sprGrid.Row = lRow
                    sprGrid.Col = 10
                    ' 해당 회원의 정보를 얻어온다.
                    If Get_고객정보(sprGrid.Text) <> "Error" Then
                        If CheckMobileNumber(고객정보.휴대전화, sTel) = True Then
                            If 고객정보.SMS전송여부 = "N" Then
                                sprGrid.Col = -1: sprGrid.Row = lRow
                                sprGrid.BackColor = vbRed
                            Else
                                sprGrid.SetText 1, lRow, "1"
                                ' 선택 수량 누적
                                bCountFlag = False
                                'txtCount(1).value = Format(Val(Replace(txtCount(1).value, ",", "")) + 1, "#,##0")
                            End If
                        End If
                    End If
                End If
            Next lRow
            
            txtCount(1).Value = CStr(GetSelectSpread(sprGrid, 1))
    End Select
    
    Exit Sub
    
ErrRtn:
    Call Error_Msg("", Err.Source, Err.Number, Err.description)

    Screen.MousePointer = 0
End Sub

Private Sub cmdList_Click()
    Call Data_Display
End Sub

Private Sub cmdSend_Click()
    Dim nIndex       As Integer
    Dim nSendCount   As Integer
    Dim sSendTel(2)  As String
    Dim sRecvTel()  As String
    Dim sValue(10)   As String
    Dim lRow         As Long
    Dim sMsg         As String
    
    On Error GoTo ErrRtn
    
    If CheckConnect = False Then Exit Sub
    
    If Val(Replace(txtCount(0).Value, ",", "")) <= 0 Then
        MsgBox "사용 가능 여부및 수량을 확인 하여 주십시요.", vbInformation, "확인"
        Exit Sub
    End If
    
    ' 전송 시간 확인
    If "18:00" < Format(Time, "hh:mm") And 가맹점정보.SMS_EMART = "Y" Then
        MsgBox "이마트에서는 18:00 이후에는 문자 메시지 발송을 할 수 없습니다.", vbInformation, "확인"
        Exit Sub
    End If
    
    If Val(lblLan2.Tag) > m_SMS_Lng Then
        MsgBox "작성된 메시지가 " & CStr(m_SMS_Lng) & "자 이상 입니다. " & CStr(m_SMS_Lng) & "자 이상은 전송할 수 없습니다.", vbCritical, "확인"
        Exit Sub
    ElseIf Val(lblLan2.Tag) <= 0 Then
        MsgBox "메시지를 확인하여 주십시요.", vbInformation, "확인"
        Exit Sub
    End If
    
    ' 광고 내용 확인
    If InStr(txtSend2.Text, "세일") > 0 Or InStr(txtSend2.Text, "행사") > 0 Or InStr(txtSend2.Text, "할인") > 0 Or InStr(txtSend2.Text, "광고") > 0 Then
        sMsg = "정보 통신망 이용 촉진 및 정보 보호 등에 관한 법률로 인한 안내" & vbNewLine
        sMsg = sMsg & vbNewLine
        sMsg = sMsg & " - 해당 화면에서는 세일, 광고, 할인, 행사와 관련된 문자를 발송할 수 없습니다." & vbNewLine
        
        Call MsgBox(sMsg, vbInformation, "확인")
        Exit Sub
    End If
    
    ' 발신자 번호 확인
    If GetCheckSMSSendTel(txtRecvTel.Text, sRecvTel, True) = False Then
        sMsg = "전기통신사업법 제84조에 의하여 문자 발신 번호는 반드시 입력 하여야 합니다." & vbNewLine
        sMsg = sMsg & vbNewLine
        sMsg = sMsg & " 주요내용" & vbNewLine
        sMsg = sMsg & " - 발신번호 없이 문자 전송 불가" & vbNewLine
        sMsg = sMsg & " - 발신번호는 수신자가 실제 발신(통화)이 가능한 번호만 허용" & vbNewLine
        sMsg = sMsg & " - 일반번호의 경우 지역번호(02,031등)를 앞자리에 포함한 번호만 허용" & vbNewLine
        sMsg = sMsg & " - 대표번호는 8자리만 입력 허용되며,내선번호 포함불가" & vbNewLine
        sMsg = sMsg & " - 030 번호의 경우 12자리까지 허용" & vbNewLine
        
        Call MsgBox(sMsg, vbInformation, "입력확인")
        
        txtRecvTel.SetFocus
        txtRecvTel.SelStart = 0: txtRecvTel.SelLength = Len(txtRecvTel.Text)
        Exit Sub
    End If

    
    ' 입력 전화 번호 확인
    nSendCount = 0
    For nIndex = 0 To txtMobile.Count - 1
        txtMobile(nIndex).Text = Trim(txtMobile(nIndex).Text)
        If txtMobile(nIndex).Text <> "" Then
            If CheckMobileNumber(txtMobile(nIndex).Text, sSendTel) = False Then
                MsgBox txtMobile(nIndex).Text & " 전화 번호로는 문자 메시지를 보낼수 없습니다.", vbInformation, "확인"
                txtMobile(nIndex).SetFocus
                txtMobile(nIndex).SelStart = 0: txtMobile(nIndex).SelLength = Len(txtMobile(nIndex).Text)
                Exit Sub
            Else
                nSendCount = nSendCount + 1
            End If
        End If
    Next nIndex
    
     
    ' 잔여수량보다 선택 수량이 더 많을 경우
    If Val(Replace(txtCount(0).Value, ",", "")) < nSendCount Then
        MsgBox "SMS 잔여 수량보다 더 많이 선택되었습니다." & vbLf & vbLf & " 전송 수량을 조절 하여 주십시요.", vbInformation, "확인"
        Exit Sub
    End If
    
    
    pnlProg.Visible = True
    pnlProg.Caption = "메시지를 전송 중 입니다. 잠시만 기다려 주십시요."
    Screen.MousePointer = vbHourglass
    DoEvents
    nSendCount = 0
    
    For nIndex = 0 To txtMobile.Count - 1
            
        ' 입력된 전화 번호가 있을 경우
        If txtMobile(nIndex).Text <> "" Then
            ' 전화 번호 검사및 휴대폰 번호 분리
            If CheckMobileNumber(txtMobile(nIndex).Text, sSendTel) = False Then
                MsgBox txtMobile(nIndex).Text & " 전화 번호로는 문자 메시지를 보낼수 없습니다.", vbInformation, "확인"
                txtMobile(nIndex).SetFocus
                txtMobile(nIndex).SelStart = 0: txtMobile(nIndex).SelLength = Len(txtMobile(nIndex).Text)
                Exit Sub
                
            ' 발송 가능한 번호일 경우 발송 한다.
            Else
                ' 전송, 메시지타입, 수신번호, 발신번호, 메시지, 지사코드, 가맹점코드, 고객코드, 고객성명, 참고5, 참고6
                sValue(0) = "1"
                sValue(1) = "0"
                sValue(2) = txtMobile(nIndex).Text
                sValue(3) = Trim(txtRecvTel.Text)
                sValue(4) = Trim(txtSend2.Text)
                sValue(5) = 가맹점정보.지사코드
                sValue(6) = 가맹점정보.택코드
                sValue(7) = " "
                sValue(8) = " "
                sValue(9) = 가맹점정보.가맹점코드
                sValue(10) = "2"
                
                Query = "EXEC PRO_SMS_SEND "
                Query = Query & "'" & sValue(0) & "', "
                Query = Query & "'" & sValue(1) & "', "
                Query = Query & "'" & sValue(2) & "', "
                Query = Query & "'" & sValue(3) & "', "
                Query = Query & "'" & sValue(4) & "', "
                Query = Query & "'" & sValue(5) & "', "
                Query = Query & "'" & sValue(6) & "', "
                Query = Query & "'" & sValue(7) & "', "
                Query = Query & "'" & sValue(8) & "', "
                Query = Query & "'" & sValue(9) & "', "
                Query = Query & "'" & sValue(10) & "' "
                
                Debug.Print Query
                
                If Dir(App.Path & "\NO_SMS.DAT", vbNormal) = "" Then
                    m_Host_DataBase.Execute Query
                    nSendCount = nSendCount + 1
                End If
            
            End If
        End If
    
    Next nIndex
    
    ' 최종 남은 수량을 설정한다.
    Call SetUseSMSCount

    pnlProg.Visible = False
    MsgBox CStr(nSendCount) & " 건 발송 되었습니다.   ", vbInformation, "확인"
    Screen.MousePointer = vbDefault
    
    On Error GoTo 0
    Exit Sub

ErrRtn:
    Screen.MousePointer = vbDefault
    pnlProg.Visible = False
    
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Sub

Private Sub cmdSendTextSave_Click(Index As Integer)
    Dim iCode As String
    
    On Error GoTo ErrRtn
    
    If 가맹점정보.SMS_EMART = "Y" And m_SMS_EMART_PASS = False Then
        MsgBox "이마트 매장에서는 수정 불가능 합니다.", vbInformation, "확인"
        Exit Sub
    End If
    
    Select Case Index
        Case 0 ' 추가
            Query = "SELECT ISNULL(MAX(순번),0) + 1 FROM TB_문자발송문"
            Set SUBRs = New ADODB.Recordset
            SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
        
            iCode = Format(SUBRs(0), "00")
            
            SUBRs.Close
            Set SUBRs = Nothing
            
            '-----------------------------------------------------------
            '
            '-----------------------------------------------------------
            Query = "SELECT * FROM TB_문자발송문"
            Query = Query & " WHERE 순번 = '" & iCode & "'"
            Set SUBRs = New ADODB.Recordset
            SUBRs.Open Query, ADOCon, adOpenDynamic, adLockOptimistic
            
            If SUBRs.EOF Then SUBRs.AddNew
            
            SUBRs!순번 = iCode & ""
            SUBRs!내용 = Trim(txtSMS.Text) & ""
            
            SUBRs.Update
            
            SUBRs.Close
            Set SUBRs = Nothing
            
        Case 1  ' 수정
            Query = "UPDATE TB_문자발송문 SET "
            Query = Query & " 내용 = '" & Trim(txtSMS.Text) & "'"
            Query = Query & " WHERE 순번 = '" & Format(lblNum.Caption, "00") & "'"
            ADOCon.Execute Query
        
        Case 2  ' 삭제
            'Query = "DELETE FROM TB_문자발송문"
            'Query = Query & " WHERE 순번 = '" & Format(lblNum.Caption, "00") & "'"
            
            Query = "UPDATE TB_문자발송문 SET "
            Query = Query & " 내용 = ''"
            Query = Query & " WHERE 순번 = '" & Format(lblNum.Caption, "00") & "'"
            ADOCon.Execute Query
    End Select
    
    'Call ReadSendTextMessage(cboSendText)
    Call 문자메시지_Display(Int(lblPage.Caption), (lblNo(0).Caption))
    
    Exit Sub
    
ErrRtn:
    Call Error_Msg("", Err.Source, Err.Number, Err.description)

    Screen.MousePointer = 0
End Sub

Private Sub cmdSvr_Click(Index As Integer)
    Select Case Index
        Case 3
            'SSPanel2.Visible = False
            
        Case 2
            If SaveConnectData = True Then
                MsgBox "저장 완료     ", vbInformation
            Else
                MsgBox "저장 실패     ", vbCritical
            End If
            
        Case 1
            ' 저장을 먼저 처리하낟.
            Call SaveConnectData
            
            If CheckConnect = True Then
                MsgBox " 연결 완료    ", vbInformation
            End If
            
        Case 0
            Call DefaultServerSetting
            
    End Select

End Sub

Private Sub Form_Activate()
    On Error GoTo ErrRtn

    Text1.Text = 가맹점정보.전화SMS
    txtRecvTel.Text = 가맹점정보.전화SMS
    
    DoEvents
    
    Call DefaultServerSetting ' 기본 설정으로 본사에 연결한다.
    
    If CheckConnect = True Then
        Call SetUseSMSCount ' 최종 남은 수량을 설정한다.
    End If

    On Error GoTo 0
    Exit Sub

ErrRtn:
    Call Error_Msg("", Err.Source, Err.Number, Err.description)

End Sub

Private Sub Form_Load()
    'TitleSet "세탁물 인도 문자"
    
    With sprGrid
        .MaxRows = 0
        .RowHeight(-1) = 14
        
        .Col = 10: .ColHidden = True
        
        'Spread 8 - 디자인
        .HighlightHeaders = HighlightHeadersOff
        .AppearanceStyle = AppearanceStyleEnhanced
        .ScrollBarStyle = ScrollBarStyleVisualStyle
        
        '선택된 Row
        .SelBackColor = &HFFFFC0 '황색 ^^
        .SelForeColor = &H0&     '검은글씨
        .OperationMode = OperationModeNormal 'OperationModeExtended
        
        'Init the User Sort
        .UserColAction = UserColActionSort
    End With
    
    With sprDetail
        .MaxRows = 0
        .RowHeight(-1) = 14
        
        'Spread 8 - 디자인
        .HighlightHeaders = HighlightHeadersOff
        .AppearanceStyle = AppearanceStyleEnhanced
        .ScrollBarStyle = ScrollBarStyleVisualStyle
        
        '선택된 Row
        .SelBackColor = &HFFFFC0 '황색 ^^
        .SelForeColor = &H0&     '검은글씨
        .OperationMode = OperationModeSingle 'OperationModeExtended
        
        'Init the User Sort
        .UserColAction = UserColActionSort
    End With
    
    dtpDay(0).Value = DateAdd("d", -33, Date)
    dtpDay(1).Value = DateAdd("d", -3, Date)
    dtpDay(2).Value = DateAdd("d", -3, Date)
    
    txtCount(0).Value = 0
    txtCount(1).Value = 0
    txtCount(2).Value = 0
    
    txtRecvTel.Text = 가맹점정보.전화SMS
    Text1.Text = 가맹점정보.전화SMS
    
    'Call ReadSendTextMessage(cboSendText)
    Call 문자메시지_Display
    
    'cmdBtn(4).Enabled = IIf(가맹점정보.SMS_EMART = "Y", False, True)
    'cmdBtn(4).Enabled = IIf(가맹점정보.SMS_EMART = "N", True, m_SMS_EMART_PASS)
    'txtSMS.Enabled = cmdBtn(4).Enabled
    
    'cmdChange.Enabled = Not cmdBtn(4).Enabled

    TabControl.SelectedItem = 0

End Sub

Private Sub 문자메시지_Display(Optional iPage As Integer = 1, Optional iNum As Integer = 0)
    On Error GoTo ErrRtn
    
    For i = 0 To 8
        lblNo(i).Caption = ""
        lblSMSMsg(i).Caption = ""
    Next i
    
    If 가맹점정보.SMS_EMART = "Y" Then
        lblPage.Caption = "1"
        lblPageCount.Caption = "1"
        
        btnMove(0).Enabled = False
        btnMove(1).Enabled = False
        
        lblNo(0).Caption = "0"
        lblSMSMsg(0).Caption = "고객님 접수하신 세탁물이 다소 지연되고 있습니다. 도착하는 대로 연락 드리겠습니다"
        
        lblNo(1).Caption = "1"
        lblSMSMsg(1).Caption = ""
        
        lblNo(2).Caption = "2"
        lblSMSMsg(2).Caption = ""
        
        lblNo(3).Caption = "3"
        lblSMSMsg(3).Caption = ""
        
        lblNo(4).Caption = "4"
        lblSMSMsg(4).Caption = ""
        
        lblNo(5).Caption = "5"
        lblSMSMsg(5).Caption = ""
        
        lblNo(6).Caption = "6"
        lblSMSMsg(6).Caption = ""
        
        lblNo(7).Caption = "7"
        lblSMSMsg(7).Caption = ""
        
        lblNo(8).Caption = "8"
        lblSMSMsg(8).Caption = ""
        
    Else
        lblPage.Caption = iPage
        
        If iPage = 1 Then
            Query = "SELECT COUNT(*) FROM TB_문자발송문"
            Set SUBRs = New ADODB.Recordset
            SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
            
            If SUBRs(0) = 0 Then
                lblPageCount.Caption = "1"
            Else
                If SUBRs(0) Mod 9 = 0 Then
                    lblPageCount.Caption = Int(SUBRs(0) / 9)
                Else
                    lblPageCount.Caption = Int(SUBRs(0) / 9) + 1
                End If
            End If
            SUBRs.Close
            Set SUBRs = Nothing
            
            '
            Query = "SELECT * FROM TB_문자발송문"
            Query = Query & " ORDER BY 순번 ASC"
            Set SUBRs = New ADODB.Recordset
            SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
        
            If SUBRs.EOF Then
                SUBRs.Close
                Set SUBRs = Nothing
                
                Query = "INSERT INTO TB_문자발송문 VALUES('01', '전할 메시지를 입력하여 주십시요')"
                ADOCon.Execute Query
            
                '--------------------------------------------
                Query = "SELECT * FROM TB_문자발송문"
                Query = Query & " ORDER BY 순번 ASC"
                Set SUBRs = New ADODB.Recordset
                SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
            End If
        Else
            Query = "SELECT TOP (9) * FROM TB_문자발송문"
            Query = Query & " WHERE 순번 >= '" & Format(iNum, "00") & "'"
            Query = Query & " ORDER BY 순번 ASC"
            Set SUBRs = New ADODB.Recordset
            SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
        End If
        
        i = 0
        
        Do Until SUBRs.EOF
            If i > 8 Then Exit Do
            
            lblSMSMsg(i).Caption = Trim(SUBRs!내용) & ""
            lblNo(i).Caption = Val(SUBRs!순번) & ""
            
            i = i + 1
            
            SUBRs.MoveNext
        Loop
        SUBRs.Close
        Set SUBRs = Nothing
    End If
    
    lblNum.Caption = "0"                                                                             'lblNo(0).Caption
    txtSMS.Text = "고객님 접수하신 세탁물이 다소 지연되고 있습니다. 도착하는 대로 연락 드리겠습니다" 'lblSMSMsg(0).Caption & ""
    
    Exit Sub

ErrRtn:
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Sub

Private Sub Form_Resize()
    On Error Resume Next
    
    cmdBtn(5).Left = (Me.Width - 200) - cmdBtn(5).Width
End Sub

Private Sub lblSMSMsg_Click(Index As Integer)
    lblNum.Caption = lblNo(Index).Caption
    
    txtSMS.Text = lblSMSMsg(Index).Caption & ""
    txtSend2.Text = lblSMSMsg(Index).Caption & ""
End Sub

Private Sub sprGrid_ButtonClicked(ByVal Col As Long, ByVal Row As Long, ByVal ButtonDown As Integer)
    If Col = 1 Then
        If ButtonDown = 0 Then
            bCountFlag = False
            
            txtCount(1).Value = txtCount(1).Value - 1
        Else
            bCountFlag = False
                        
            txtCount(1).Value = txtCount(1).Value + 1
        End If
    End If
End Sub

Private Sub sprGrid_Click(ByVal Col As Long, ByVal Row As Long)
    If Row <= 0 Then Exit Sub
    
    sprGrid.Row = Row
    sprGrid.Col = 10
    Call DisplayDetailData(sprGrid.Text)
End Sub

Private Sub sprGrid_LeaveCell(ByVal Col As Long, ByVal Row As Long, ByVal NewCol As Long, ByVal NewRow As Long, Cancel As Boolean)
    Call sprGrid_Click(NewCol, NewRow)
End Sub

Private Sub txtCount_Change(Index As Integer)
    ' 선택 수량이 변경될 경우 전송후 수량을 수정하여 준다.
    
    Debug.Print bCountFlag
    
    If Index = 1 Then
        If bCountFlag = True Then Exit Sub
        
        txtCount(2).Value = txtCount(0).Value - txtCount(1).Value
        bCountFlag = True
    End If
End Sub
 
Private Sub sprDetail_ButtonClicked(ByVal Col As Long, ByVal Row As Long, ByVal ButtonDown As Integer)
    If bSSChangeFlag = True Then Exit Sub
    If bSSChangeFlag2 = True Then Exit Sub
    
    If Col = 1 Then
        Dim sTel(2) As String
        
        ' 선택을 해지 하면 선택 수량에서 -1를 해준다.
        If ButtonDown = 0 Then
            bCountFlag = False
            txtCount(1).Value = txtCount(1).Value - 1
            
            Exit Sub
        Else
            
            bSSChangeFlag2 = True
            sprGrid.Row = Row:   sprGrid.Col = 4
            
            If CheckMobileNumber(sprGrid.Text, sTel) = True Then
                bCountFlag = False
                txtCount(1).Value = txtCount(1).Value + 1
            Else
                MsgBox "선택된 전화번호로는 문자 메시지를 보낼수 없습니다.", vbInformation, "확인"
                sprGrid.Row = Row:   sprGrid.Col = 1
                sprGrid.Value = 0
            End If
            bSSChangeFlag2 = False
        End If
    End If
End Sub
 
Private Sub txtMobile_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
    If KeyCode = vbKeyReturn Then
        SendKeys "{Tab}"
    End If
End Sub

Private Sub txtSend2_Change()
    lblLan2.Tag = CStr(LenB(StrConv(txtSend2.Text, vbFromUnicode)))
    lblLan2.Caption = lblLan2.Tag & "자"
    
    If LenB(StrConv(txtSend2.Text, vbFromUnicode)) > m_SMS_Lng Then
        lblLan2.BackColor = vbRed
        MsgBox "작성된 메시지가 " & CStr(m_SMS_Lng) & "자 이상 입니다. " & CStr(m_SMS_Lng) & "자 이상은 전송할 수 없습니다.", vbCritical, "확인"
        Exit Sub
    Else
        lblLan2.BackColor = &HC0C0FF
        Exit Sub
    End If
End Sub

Private Sub txtSend2_KeyPress(KeyAscii As Integer)
    ' '입력이 안되도록 수정
    If KeyAscii = 39 Then
        KeyAscii = 0
    End If

End Sub

Private Sub txtSMS_Change()
    lbl_SMS.Tag = CStr(LenB(StrConv(txtSMS.Text, vbFromUnicode)))
    lbl_SMS.Caption = lbl_SMS.Tag & "자"
    Debug.Print lbl_SMS.Tag & "자"
    
    If LenB(StrConv(txtSMS.Text, vbFromUnicode)) > m_SMS_Lng Then
        lbl_SMS.BackColor = vbRed
        MsgBox "작성된 메시지가 " & CStr(m_SMS_Lng) & "자 이상 입니다. " & CStr(m_SMS_Lng) & "자 이상은 전송할 수 없습니다.", vbCritical, "확인"
        Exit Sub
    Else
        lbl_SMS.BackColor = Me.BackColor
    End If

End Sub


Private Sub DefaultServerSetting()
    On Error GoTo ErrRtn

    Query = "SELECT    ISNULL(SMS_IP,'115.89.220.5,8657') AS SMS_IP"
    Query = Query & ", ISNULL(SMS_DB,'Laundry1000') AS SMS_DB"
    Query = Query & ", ISNULL(SMS_ID,'sa') AS SMS_ID"
    Query = Query & ", ISNULL(SMS_PWD,'cleanaid1996!@#') AS SMS_PWD"
    Query = Query & ", ISNULL(TIMEOUT,30) AS TIMEOUT"
    Query = Query & " FROM TB_기본정보"
    Set ADORs = New ADODB.Recordset
    ADORs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
    
    If ADORs.EOF Then
        txtServer(0).Text = "115.89.220.5,8657" '
        txtServer(1).Text = "Laundry1000"                    '
        txtServer(2).Text = "sa"                         '
        txtServer(3).Text = "cleanaid1996!@#"                           '
        m_CommandTimeOut = 30                            '
    Else
        txtServer(0).Text = Trim(ADORs!SMS_IP) & ""      '
        txtServer(1).Text = Trim(ADORs!SMS_DB) & ""      '
        txtServer(2).Text = Trim(ADORs!SMS_ID) & ""      '
        txtServer(3).Text = Trim(ADORs!SMS_PWD) & ""     '
        m_CommandTimeOut = Val(Trim(ADORs!timeout) & "") '
    End If
    ADORs.Close
    Set ADORs = Nothing

    Exit Sub

ErrRtn:
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Sub


'-------------------------------------------------------------------------------------
' 내용 구분의 정보를 저장 한다.
'-------------------------------------------------------------------------------------
Private Function SaveConnectData() As Boolean
    
    On Error GoTo ErrRtn
    Dim Query    As String
    
    SaveConnectData = False
    
    txtServer(0).Text = Trim(txtServer(0).Text)
    txtServer(1).Text = Trim(txtServer(1).Text)
    txtServer(2).Text = Trim(txtServer(2).Text)
    txtServer(3).Text = Trim(txtServer(3).Text)
    
    Query = "UPDATE TB_기본정보 SET "
    Query = Query & " SMS_IP = ' " & txtServer(0).Text & "', "
    Query = Query & " SMS_DB = ' " & txtServer(1).Text & "', "
    Query = Query & " SMS_ID = ' " & txtServer(2).Text & "', "
    Query = Query & " SMS_PWD = ' " & txtServer(3).Text & "' "
    ADOCon.Execute Query
    
    SaveConnectData = True
    
    On Error GoTo 0
    
    Exit Function

ErrRtn:
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Function


Private Function CheckConnect() As Boolean
    On Error GoTo ErrRtn
    
    Dim HostConn    As String
    
    HostConn = ""
    HostConn = HostConn & "Provider=SQLOLEDB.1;"
    HostConn = HostConn & "Persist Security Info=False;"
    HostConn = HostConn & "User ID=" & txtServer(2).Text & ";"
    HostConn = HostConn & "Password=" & txtServer(3).Text & ";"
    HostConn = HostConn & "Initial Catalog=" & txtServer(1).Text & ";"
    HostConn = HostConn & "Data Source=" & txtServer(0).Text
    m_CommandTimeOut = IIf(m_CommandTimeOut = 0, 30, m_CommandTimeOut)

    Set m_Host_DataBase = Nothing
    Set m_Host_DataBase = New ADODB.Connection
    
    
    pnlProg.Visible = True
    pnlProg.Caption = "서버에 연결중 입니다. 잠시만 기다려 주십시요..."
    
    If m_Host_DataBase.State = adStateOpen Then m_Host_DataBase.Close
    
    m_Host_DataBase.ConnectionTimeout = 10
    m_Host_DataBase.CommandTimeout = m_CommandTimeOut
    m_Host_DataBase.Open HostConn
    
    
    pnlProg.Visible = False
    
    m_Connect = True
    CheckConnect = True

    Exit Function

ErrRtn:
    pnlProg.Visible = False
    
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Function



'--------------------------------------------------------------------------------------------------------------
' Procedure : SetUseSMSCount
' DateTime  : 2007-06-10 12:26
' Author    : pds2004
' Purpose   : 문자 메시지의 잔여 수량을 가저온다.
'--------------------------------------------------------------------------------------------------------------
Private Sub SetUseSMSCount()
    Dim bResult     As Boolean
    Dim ADORset     As New ADODB.Recordset
    
    ' 연결되어 있지 않을 경우 다시한번 연결을 시도한다.
    On Error GoTo ErrRtn

    txtCount(0).Value = 0
    
    If m_Connect = False Then
        If CheckConnect = False Then
            MsgBox "본사와의 연결 설정을 확인하여 주십시요", vbInformation, "확인"
            ' 설정 화면을 활성화 한다.
            Call cmdBtn_Click(2)
            Exit Sub
        End If
    End If
    
    Query = "EXEC PRO_SMS_STORE_001_01 '0', '" & 가맹점정보.가맹점코드 & "' "

    ADORset.CursorLocation = adUseClient
    ADORset.Open Query, m_Host_DataBase, adOpenStatic, adLockBatchOptimistic, adCmdText
    
    If ADORset.EOF = False Then
        If ADORset.RecordCount > 0 Then
            txtCount(0).Value = ADORset!잔여수량
        End If
    End If
    ADORset.Close
    Set ADORset = Nothing

    txtCount(2).Value = txtCount(0).Value - txtCount(1).Value
    
    Exit Sub

ErrRtn:
    Set ADORset = Nothing
    
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Sub


Private Sub Data_Display()
    
    Dim FindCount   As Integer
    Dim sTel(2)     As String
    Dim lRow        As Long
    Dim bResult     As Boolean
    Dim sData(1)    As String
    Dim sLastDate   As String

    On Error GoTo ErrRtn
    
    Screen.MousePointer = 11
    
    txtCount(1).Value = 0
    txtCount(2).Value = 0
    
    bSSChangeFlag = True

    Query = ""
    Query = Query & "SELECT aa.고객코드, dd.성명, dd.전화번호, dd.휴대전화, dd.문자발송여부,CC.TagS , CC.TagE, CC.TagCnt, EE.ReturnCnt"
    Query = Query & "          FROM TB_입출고 AA"
    Query = Query & ""
    Query = Query & "    left outer join TB_입출고 BB"
    Query = Query & "        on aa.고객코드 = BB.고객코드"
    Query = Query & "        and bb.접수일자  between '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'   AND  '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "'"
    Query = Query & "        AND (bb.가맹점입고일자 = '' OR bb.가맹점입고일자 IS NULL)"
    Query = Query & "        AND (bb.판매취소 <> 'Y')"
    Query = Query & ""
    Query = Query & "    left outer join ("
    Query = Query & "            select 고객코드, MIN(택번호) as TagS, MAX(택번호) as TagE, COUNT(택번호) as TagCnt"
    Query = Query & "              From TB_입출고"
    Query = Query & "            where 접수일자  between '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'   AND  '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "'"
    Query = Query & "            AND (가맹점입고일자 = '' OR 가맹점입고일자 IS NULL) "
    Query = Query & "            AND 판매취소 <> 'Y'"
    Query = Query & "            AND (출고일자 = '' OR 출고일자 IS NULL)"
    Query = Query & "            group by 고객코드) CC"
    Query = Query & "        on AA.고객코드 = CC.고객코드"
    Query = Query & "        "
    Query = Query & "    left outer join TB_고객정보 DD"
    Query = Query & "        on AA.고객코드 = DD.고객코드"
    Query = Query & ""
    Query = Query & "    left outer join ("
    Query = Query & "            select 고객코드, count(택번호) as ReturnCnt"
    Query = Query & "              From TB_입출고"
    Query = Query & "            where 접수일자  between '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'  AND  '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "'"
    Query = Query & "            AND 지사출고상태 = '2'"
    Query = Query & "            AND 판매취소 <> 'Y'"
    Query = Query & "            AND (출고일자 = '' OR 출고일자 IS NULL)"
    Query = Query & "            group by 고객코드) EE"
    Query = Query & "        on AA.고객코드 = EE.고객코드"
    Query = Query & ""
    Query = Query & " WHERE aa.접수일자 between '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'   AND   '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "'"
    Query = Query & "   AND (aa.가맹점입고일자 = '' OR aa.가맹점입고일자 IS NULL)"
    Query = Query & "   AND (aa.출고일자 = '' OR aa.출고일자 IS NULL)"
    Query = Query & "   AND (aa.판매취소 <> 'Y')"
    Query = Query & " group by aa.고객코드, dd.성명, dd.전화번호, dd.휴대전화, dd.문자발송여부,  CC.TagS , CC.TagE, CC.TagCnt, EE.ReturnCnt"



    Set ADORs = New ADODB.Recordset
    ADORs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
        
    With sprGrid
        .MaxRows = 0
        .ReDraw = False
        
        'ButtonClicked 이벤트를 발생시키지 않도록한다. ButtonClicked 발생하면 선택수량이 이중계산됨...
        .EventEnabled(EventButtonClicked) = False
        
        lRow = 0
        Do Until ADORs.EOF
                

            .MaxRows = .MaxRows + 1
            .Row = .MaxRows
                        
            .Col = 2: .Text = ADORs!성명 & ""
            .Col = 3: .Text = ADORs!전화번호 & ""
            .Col = 4: .Text = ADORs!휴대전화 & ""
            .Col = 5: .Text = Format(ADORs!TagS, "000-00-0000") & "" '
            .Col = 6: .Text = Format(ADORs!TagE, "000-00-0000") & "" '
            .Col = 7: .Text = ADORs!TagCnt & ""           '
            .Col = 9: .Text = sLastDate
            .Col = 8: .Text = Val(ADORs!ReturnCnt & "")  ' 반품수량
            .Col = 9: .Text = ""                    ' 최종 전송일
            .Col = 10: .Text = ADORs!고객코드 & ""   '
            
                
            '-----------------------------------------------------------------------------------
            ' 고객 문자 발송 여부
            If CheckMobileNumber(ADORs!휴대전화 & "", sTel) = True Then
                If ADORs!문자발송여부 & "" = "N" Then
                    .Col = 1: .Text = "0"                          ' 1
                    
                    .Col = -1: .BackColor = vbRed
                               .ForeColor = vbWhite
                Else
                    bCountFlag = False
                    .Col = 1: .Text = "1"                          ' 1
                    txtCount(1).Value = txtCount(1).Value + 1 ' 선택 수량 누적
                
                End If
            
                If sLastDate <> "연결오류" Then
                    sLastDate = GetLastUseDate(ADORs!휴대전화 & "") '-- 시간이 너무 걸리네 ㅡㅡ
                    .Col = 9: .Text = sLastDate
                End If
            
            
            Else
                .Col = 1: .Text = "0"                              ' 1
                
                .Col = -1: .BackColor = vbYellow
                           .ForeColor = vbBlack
            End If
            
            ADORs.MoveNext
        Loop
        
        ADORs.Close
        Set ADORs = Nothing
        
        .EventEnabled(EventButtonClicked) = True
        .ReDraw = True
    End With
    
    bSSChangeFlag = False
    
    Screen.MousePointer = vbDefault
    
    Exit Sub

ErrRtn:
    sprDetail.ReDraw = True
    bSSChangeFlag = False
    Screen.MousePointer = vbDefault
    
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Sub


Private Sub Data_Display_20150714()
    Dim FindCount   As Integer
    Dim sTel(2)     As String
    Dim lRow        As Long
    Dim bResult     As Boolean
    Dim sData(1)    As String

    On Error GoTo ErrRtn
    
    Screen.MousePointer = 11
    
    txtCount(1).Value = 0
    txtCount(2).Value = 0
    
    bSSChangeFlag = True

    '--------------------------------------------------------------------------------
    ' 해당 일자에 입고된 고객 번호 내역을 구한다.
    '--------------------------------------------------------------------------------
    Query = "SELECT 고객코드 FROM TB_입출고"
    Query = Query & " WHERE (접수일자 >= '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'"
    Query = Query & "   AND  접수일자 <= '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "')"
    Query = Query & "   AND (가맹점입고일자 = '' OR 가맹점입고일자 IS NULL)"
    Query = Query & "   AND (출고일자 = '' OR 출고일자 IS NULL)"
    Query = Query & "   AND (판매취소 <> 'Y')"
    Query = Query & " GROUP BY 고객코드"
    Set ADORs = New ADODB.Recordset
    ADORs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
        
    With sprGrid
        .MaxRows = 0
        .ReDraw = False
        
        'ButtonClicked 이벤트를 발생시키지 않도록한다. ButtonClicked 발생하면 선택수량이 이중계산됨...
        .EventEnabled(EventButtonClicked) = False
        
        lRow = 0
        Do Until ADORs.EOF
            '-----------------------------------------------------------------------------------
            ' 위에서 조회된 내용을 기준으로 해당 일자에 미 입고된 내용이 있는지 확인한다.
            ' 없을 경우에만 문자 메시지를 전송 처리하기 위하여 리스트에 표시한다.
            '-----------------------------------------------------------------------------------
            Query = " SELECT * FROM TB_입출고"
            Query = Query & " WHERE (접수일자 >= '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'"
            Query = Query & "   AND  접수일자 <= '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "')"
            Query = Query & "   AND 고객코드   = '" & ADORs!고객코드 & "" & "'"
            Query = Query & "   AND (가맹점입고일자 = '' OR 가맹점입고일자 IS NULL)"
            Query = Query & "   AND (판매취소 <> 'Y')"
            Set SUBRs = New ADODB.Recordset
            SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
            
            ' 미입고된 내용이 있을 경우
            If Not SUBRs.EOF Then
                SUBRs.Close
                Set SUBRs = Nothing
                
                ' 해당 회원의 정보를 얻어온다.
                If Get_고객정보(ADORs!고객코드) <> "Error" Then
                    .MaxRows = .MaxRows + 1
                    .Row = .MaxRows
                                
                    .Col = 2: .Text = 고객정보.성명 & ""     '
                    .Col = 3: .Text = 고객정보.전화번호 & "" '
                    .Col = 4: .Text = 고객정보.휴대전화 & "" '
                                        
                    '-----------------------------------------------------------------------------------
                    ' 미입고된 내역의 정보를 구한다. 시작텍과 종료텍의 수량을 구한다.
                    '-----------------------------------------------------------------------------------
                    Query = " SELECT   MIN(택번호)       As 시작번호"
                    Query = Query & ", MAX(택번호)       AS 종료번호"
                    Query = Query & ", COUNT(택번호)     AS 수량"
                    Query = Query & ", MAX(지사출고일자) AS 본사출고일"
                    Query = Query & " FROM TB_입출고"
                    Query = Query & " WHERE (접수일자 >= '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'"
                    Query = Query & "   AND  접수일자 <= '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "')"
                    Query = Query & "   AND 고객코드   = '" & Trim(ADORs!고객코드) & "'"
                    Query = Query & "   AND (가맹점입고일자 = '' OR 가맹점입고일자 IS NULL)"
                    Query = Query & "   AND (판매취소 <> 'Y')"
                    Query = Query & "   AND (출고일자 = '' OR 출고일자 IS NULL)"
                    Set SUBRs = New ADODB.Recordset
                    SUBRs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly
                    
                    If Not SUBRs.EOF Then
                        .Col = 5: .Text = Format(SUBRs!시작번호, "000-00-0000") & "" '
                        .Col = 6: .Text = Format(SUBRs!종료번호, "000-00-0000") & "" '
                        .Col = 7: .Text = SUBRs!수량 & ""           '
                        
                        If Trim(고객정보.휴대전화) = "" Then
                            .Col = 9: .Text = ""
                        Else
                            .Col = 9: .Text = GetLastUseDate(고객정보.휴대전화) '-- 시간이 너무 걸리네 ㅡㅡ
                        End If
                        
                        .Col = 10: .Text = 고객정보.고객코드 & ""   '
                    End If
                    SUBRs.Close
                    Set SUBRs = Nothing
                    
                    '-----------------------------------------------------------------------------------
                    ' 반품수량
                    .Col = 8: .Text = Get_반품수량(Format(dtpDay(0).Value, "YYYY-MM-DD"), Format(dtpDay(1).Value, "YYYY-MM-DD"), Trim(ADORs!고객코드))
                    
                    If CheckMobileNumber(고객정보.휴대전화, sTel) = True Then
                        If 고객정보.SMS전송여부 = "N" Then
                            .Col = 1: .Text = "0"                          ' 1
                            
                            .Col = -1: .BackColor = vbRed
                                       .ForeColor = vbWhite
                        Else
                            .Col = 1: .Text = "1"                          ' 1
                            
                            bCountFlag = False
                            
                            txtCount(1).Value = txtCount(1).Value + 1 ' 선택 수량 누적
                        End If
                    Else
                        .Col = 1: .Text = "0"                              ' 1
                        
                        .Col = -1: .BackColor = vbYellow
                                   .ForeColor = vbBlack
                    End If

                End If
            Else
                SUBRs.Close
                Set SUBRs = Nothing
            End If
            
            ADORs.MoveNext
        Loop
        ADORs.Close
        Set ADORs = Nothing
        
        .EventEnabled(EventButtonClicked) = True
        .ReDraw = True
    End With
    
    bSSChangeFlag = False
    
    Screen.MousePointer = vbDefault
    
    Exit Sub

ErrRtn:
    sprDetail.ReDraw = True
    bSSChangeFlag = False
    Screen.MousePointer = vbDefault
    
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Sub


'--------------------------------------------------------------------------------------------------------------
' Procedure : SendSMS
' DateTime  : 2007-05-06 23:16
' Author    : pds2004
' Purpose   : SMS 문자 메시지 전송
'--------------------------------------------------------------------------------------------------------------
Private Function SendSMS() As Boolean
    Dim sFlag       As Boolean
    Dim lRow        As Long
    Dim dLng        As Long
    Dim sValue(10)  As String
    Dim vTemp       As Variant
    Dim bResult     As Boolean
    Dim Query       As String
    Dim sRecvTel() As String
    Dim ADORset     As New ADODB.Recordset
    Dim sMsg        As String
    
    
    On Error GoTo ErrRtn
    
    ' 문자 메시지 길이 확인
    dLng = CheckSendMessageLangth
    
    If dLng <= 0 Or dLng > m_SMS_Lng Then Exit Function
    
    ' 전송 시간 확인
    If "18:00" < Format(Time, "hh:mm") And 가맹점정보.SMS_EMART = "Y" Then
        MsgBox "이마트에서는 18:00 이후에는 문자 메시지 발송을 할 수 없습니다.", vbInformation, "확인"
        Exit Function
    End If
    
    ' 잔여 수량 확인
    If Val(Replace(txtCount(2).Value, ",", "")) < 0 Then
        MsgBox "잔여 수량보다 선택수량이 더 큼니다. 선택 수량을 조절하여 주십시요.", vbInformation, "확인"
        Exit Function
    End If

    ' 광고 내용 확인
    If InStr(txtSMS.Text, "세일") > 0 Or InStr(txtSMS.Text, "행사") > 0 Or InStr(txtSMS.Text, "행사") > 0 Or InStr(txtSMS.Text, "광고") > 0 Then
        sMsg = "정보 통신망 이용 촉진 및 정보 보호 등에 관한 법률로 인한 안내" & vbNewLine
        sMsg = sMsg & vbNewLine
        sMsg = sMsg & " - 해당 화면에서는 세일, 광고, 할인, 행사와 관련된 문자를 발송할 수 없습니다." & vbNewLine
        
        Call MsgBox(sMsg, vbInformation, "확인")
        Exit Function
    End If
    
    If GetCheckSMSSendTel(Text1.Text, sRecvTel, True) = False Then
        sMsg = "전기통신사업법 제84조에 의하여 문자 발신 번호는 반드시 입력 하여야 합니다." & vbNewLine
        sMsg = sMsg & vbNewLine
        sMsg = sMsg & " 주요내용" & vbNewLine
        sMsg = sMsg & " - 발신번호 없이 문자 전송 불가" & vbNewLine
        sMsg = sMsg & " - 발신번호는 수신자가 실제 발신(통화)이 가능한 번호만 허용" & vbNewLine
        sMsg = sMsg & " - 일반번호의 경우 지역번호(02,031등)를 앞자리에 포함한 번호만 허용" & vbNewLine
        sMsg = sMsg & " - 대표번호는 8자리만 입력 허용되며,내선번호 포함불가" & vbNewLine
        sMsg = sMsg & " - 030 번호의 경우 12자리까지 허용" & vbNewLine
        
        Call MsgBox(sMsg, vbInformation, "입력확인")
        
        Text1.SetFocus
        Text1.SelStart = 0: Text1.SelLength = Len(Text1.Text)
        Exit Function
    End If


    If m_Connect = False Then
        If CheckConnect = False Then
            MsgBox "본사와의 연결 설정을 확인하여 주십시요", vbInformation, "확인"
            ' 설정 화면을 활성화 한다.
            Call cmdBtn_Click(2)
            Exit Function
        End If
    End If
    
    ' 최종 확인 메시지
            Query = "본 출고 자료는 정확 하지 않을수 있습니다!!!!" & vbNewLine & vbNewLine
    Query = Query & "가맹점에서 반드시 확인후 문자 메시지를 발송바랍니다." & vbNewLine & vbNewLine
    Query = Query & "메시지를 전송 하시겠습니까? "
    Rtn = MsgBox(Query, vbCritical + vbYesNo + vbDefaultButton2, "확인")
       
    If Rtn = vbNo Then
        Exit Function
    End If
 
    For lRow = 1 To sprGrid.MaxRows
        sprGrid.Row = lRow
        sprGrid.Col = 1: vTemp = sprGrid.Text
        
        sFlag = IIf(CStr(vTemp) = "1", True, False)
        
        ' 전송 구분일 경우 전송 처리한다.
        If sFlag = True Then
                              sValue(0) = "1"                   '전송
                              sValue(1) = "0"                   '메시지타입
            sprGrid.Col = 4:  sValue(2) = CStr(sprGrid.Text)    '수신번호
                              sValue(3) = Trim(Text1.Text)      '발신번호
                              sValue(4) = Trim(txtSMS.Text)     '메시지
                              sValue(5) = 가맹점정보.지사코드   '지사코드
                              sValue(6) = 가맹점정보.택코드     '가맹점코드
            sprGrid.Col = 10: sValue(7) = CStr(sprGrid.Text)    '고객코드
            sprGrid.Col = 2:  sValue(8) = CStr(sprGrid.Text)    '고객성명
                              sValue(9) = 가맹점정보.가맹점코드 '참고5
                              sValue(10) = "4"                  '참고6
            
            Query = "EXEC PRO_SMS_SEND"
            Query = Query & "  '" & sValue(0) & "'"  ' 1 FLAG
            Query = Query & ", '" & sValue(1) & "'"  ' 2 MSGTYPE
            Query = Query & ", '" & sValue(2) & "'"  ' 3 PHONE
            Query = Query & ", '" & sValue(3) & "'"  ' 4 CALLBACK
            Query = Query & ", '" & sValue(4) & "'"  ' 5 MSG
            Query = Query & ", '" & sValue(5) & "'"  ' 6 MASTERCODE
            Query = Query & ", '" & sValue(6) & "'"  ' 7 STORECODE
            Query = Query & ", '" & sValue(7) & "'"  ' 8 CUSTCODE
            Query = Query & ", '" & sValue(8) & "'"  ' 9 ETC4
            Query = Query & ", '" & sValue(9) & "'"  '10 ETC5
            Query = Query & ", '" & sValue(10) & "'" '11 ETC6
            
            If Dir(App.Path & "\NO_SMS.DAT", vbNormal) = "" Then
                m_Host_DataBase.Execute Query
            
                vTemp = "0"
                Call sprGrid.SetText(1, lRow, vTemp)
            End If
        End If
    Next lRow
    
    ' 최종 남은 수량을 설정한다.
    Call SetUseSMSCount
    
    Set ADORset = Nothing
    
    On Error GoTo 0
    Exit Function

ErrRtn:
    ' 최종 남은 수량을 설정한다.
    Call SetUseSMSCount
    DoEvents
    
    Set ADORset = Nothing
    
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Function


Private Function CheckSendMessageLangth() As Integer
    If IsNumeric(lbl_SMS.Tag) = False Then
        CheckSendMessageLangth = 0
        txtSMS.SetFocus
        MsgBox "전송할 메시지를 입력 하여 주십시요..  [" & CStr(Val(lbl_SMS.Tag)) & "자]", vbInformation, "확인"
        Exit Function
        
    ElseIf Val(lbl_SMS.Tag) >= m_SMS_Lng Then
        CheckSendMessageLangth = Val(lbl_SMS.Tag)
        txtSMS.SetFocus
        MsgBox "전송할 메시지를 확인 하여 주십시요..  [" & CStr(Val(lbl_SMS.Tag)) & "자]", vbInformation, "확인"
        Exit Function
    Else
        CheckSendMessageLangth = Val(lbl_SMS.Tag)
        Exit Function
    End If
End Function



'Private Function ReadSendTextMessage() As Boolean
'    Dim TempRSet    As Recordset
'    Dim Query    As String
'
'
'    cboSendText.Clear
'
'    Query = " SELECT * "
'    Query = Query & "  FROM TB_문자발송문 "
'    Query = Query & " ORDER BY 순번 "
'    Set TempRSet = MyDB.OpenRecordset(Query)
'
'    If TempRSet.EOF Then
'        cboSendText.AddItem "전할 메시지를 입력하여 주십시요"
'    End If
'
'
'    While Not TempRSet.EOF
'        cboSendText.AddItem Trim(TempRSet.Fields("내용") & "")
'        TempRSet.MoveNext
'    Wend
'
'    ' 마지막 문구 선택
'    If cboSendText.ListCount >= 0 Then
'        cboSendText.ListIndex = cboSendText.ListCount - 1
'
'    End If
'
'    TempRSet.Close
'End Function

'----------------------------------------------------------------------------------------
' 함수명 : DisplayDetailData
' 설  명 :
'----------------------------------------------------------------------------------------
Private Sub DisplayDetailData(ByVal sCustCode As String)
    Query = "SELECT * FROM TB_입출고"
    Query = Query & " WHERE (접수일자 >= '" & Format(dtpDay(0).Value, "YYYY-MM-DD") & "'"
    Query = Query & "   AND  접수일자 <= '" & Format(dtpDay(1).Value, "YYYY-MM-DD") & "')"
    Query = Query & "   AND 고객코드   = '" & sCustCode & "'"
    Query = Query & "   AND (출고일자  = '' OR 출고일자 IS NULL)"
    Query = Query & "   AND 판매취소  <> 'Y'"
    
    'Query = Query & "   AND 지사출고일자 <> ''"
    'Query = Query & "   AND (반품환불일자 IS NULL OR 반품환불일자 = '')"
    'Query = Query & "   AND (세탁환불일자 IS NULL OR 세탁환불일자 = ''))"
    'Query = Query & "   AND (가맹점입고일자 = '' OR 가맹점입고일자 IS NULL)"
    Set ADORs = New ADODB.Recordset
    ADORs.Open Query, ADOCon, adOpenForwardOnly, adLockReadOnly

    With sprDetail
        .MaxRows = 0
        .ReDraw = False
        
        Do Until ADORs.EOF
            .MaxRows = .MaxRows + 1
            .Row = .MaxRows
            .Col = 1: .Text = Format(ADORs!접수일자, "YYYY-MM-DD")     '
            .Col = 2: .Text = Trim(ADORs!의류명) & ""                  '
            .Col = 3: .Text = Trim(ADORs!무늬) & ""                    '
            .Col = 4: .Text = Trim(ADORs!색상) & ""                    '
            .Col = 5: .Text = Trim(ADORs!내용) & ""                    '
            
            If Len(ADORs!택번호) = 9 Then
                .Col = 6: .Text = Format(ADORs!택번호, "000-00-0000") & "" '
            Else
                .Col = 6: .Text = Trim(ADORs!택번호) & ""                  '
            End If
            
            If Trim(ADORs!가맹점입고일자) = "00:00:00" Then
                .Col = 7: .Text = Left(ADORs!지사출고일자, 10)   '이전 지사출고일자
            Else
                .Col = 7: .Text = Left(ADORs!가맹점입고일자, 10) '이전 지사출고일자
            End If
            
            If IsNumeric(ADORs!지사출고상태 & "") = True Then
                .Col = 8: .Text = Choose(ADORs!지사출고상태 & "", "정상", "반품", "확인", "품명")                   '
            End If
            
            ADORs.MoveNext
        Loop
        ADORs.Close
        Set ADORs = Nothing
        
        .ReDraw = True
    End With
End Sub

'--------------------------------------------------------------------------------------------------------------
' Procedure : GetLastUseDate
' DateTime  : 2008-06-7
' Author    : pds2004
' Purpose   : 최종 사용일자를 리턴한다.
'--------------------------------------------------------------------------------------------------------------
Private Function GetLastUseDate(ByVal CustPhone As String) As String
    Dim bResult   As Boolean
    Dim ADORset   As New ADODB.Recordset
    
    ' 연결되어 있지 않을 경우 다시한번 연결을 시도한다.
    On Error GoTo ErrRtn

    If m_Connect = False Then
        If CheckConnect = False Then
            MsgBox "본사와의 연결 설정을 확인하여 주십시요", vbInformation, "확인"
            ' 설정 화면을 활성화 한다.
            Call cmdBtn_Click(2)
            Exit Function
        End If
    End If
    
    Query = "EXEC PRO_SMS_STORE_001_06 '" & 가맹점정보.가맹점코드 & "', '" & CustPhone & "'"

    ADORset.CursorLocation = adUseClient
    ADORset.Open Query, m_Host_DataBase, adOpenStatic, adLockBatchOptimistic, adCmdText
    
    If ADORset.EOF = False Then
        If ADORset.RecordCount > 0 Then
            GetLastUseDate = ADORset.Fields("전송정보") & ""
        End If
    End If
    ADORset.Close
    Set ADORset = Nothing

    Exit Function

ErrRtn:
    Set ADORset = Nothing
    
    Call Error_Msg("", Err.Source, Err.Number, Err.description)
End Function

Private Sub txtSMS_KeyPress(KeyAscii As Integer)
    If 가맹점정보.SMS_EMART = "Y" And m_SMS_EMART_PASS = False Then
        KeyAscii = 0
    End If
    ' '입력이 안되도록 수정
    If KeyAscii = 39 Then
        KeyAscii = 0
    End If
End Sub
